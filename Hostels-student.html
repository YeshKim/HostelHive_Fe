<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hostel Hive - Search Results</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        line-height: 1.6;
        color: #333;
        background: #f8f9fa;
      }

      /* Header Styles */
      header {
        background: linear-gradient(135deg, #8b5cf6, #a855f7);
        color: white;
        padding: 1rem 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      nav {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-size: 1.8rem;
        font-weight: bold;
      }

      .nav-links {
        display: flex;
        list-style: none;
        gap: 2rem;
      }

      .nav-links a {
        color: white;
        text-decoration: none;
        transition: opacity 0.3s;
      }

      .nav-links a:hover {
        opacity: 0.8;
      }

      .auth-buttons {
        display: flex;
        gap: 1rem;
      }

      .btn {
        padding: 0.5rem 1.5rem;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        transition: all 0.3s;
        font-size: 0.9rem;
      }

      .btn-outline {
        background: transparent;
        color: white;
        border: 2px solid white;
      }

      .btn-outline:hover {
        background: white;
        color: #8b5cf6;
      }

      .btn-solid {
        background: white;
        color: #8b5cf6;
        border: 2px solid white;
      }

      .btn-primary {
        background: #7c3aed;
        color: white;
        border: none;
      }

      .btn-primary:hover {
        background: #6d28d9;
      }

      /* Search Bar */
      .search-bar {
        background: white;
        padding: 1.5rem 0;
        border-bottom: 1px solid #e5e7eb;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }

      .search-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      .search-form {
        display: flex;
        gap: 1rem;
        align-items: center;
        flex-wrap: wrap;
      }

      .search-input {
        flex: 1;
        min-width: 200px;
        padding: 0.8rem;
        border: 2px solid #e5e7eb;
        border-radius: 5px;
        font-size: 1rem;
      }

      .search-input:focus {
        outline: none;
        border-color: #8b5cf6;
      }

      .budget-inputs {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }

      .budget-inputs input {
        width: 120px;
        padding: 0.8rem;
        border: 2px solid #e5e7eb;
        border-radius: 5px;
        font-size: 0.9rem;
      }

      .budget-inputs span {
        color: #666;
        font-weight: 500;
      }

      .search-btn {
        background: #8b5cf6;
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: background 0.3s;
      }

      .search-btn:hover {
        background: #7c3aed;
      }

      /* Main Content */
      .main-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        display: grid;
        grid-template-columns: 300px 1fr;
        gap: 2rem;
      }

      /* Filters Sidebar */
      .filters {
        background: white;
        padding: 1.5rem;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        height: fit-content;
        position: sticky;
        top: 2rem;
      }

      .filters h3 {
        color: #8b5cf6;
        margin-bottom: 1rem;
        font-size: 1.2rem;
      }

      .filter-group {
        margin-bottom: 1.5rem;
      }

      .filter-group h4 {
        color: #333;
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      .filter-options {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .filter-options label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        padding: 0.3rem 0;
        transition: color 0.3s;
      }

      .filter-options label:hover {
        color: #8b5cf6;
      }

      .filter-options input[type="checkbox"] {
        accent-color: #8b5cf6;
      }

      .price-range {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .price-range input {
        padding: 0.5rem;
        border: 1px solid #e5e7eb;
        border-radius: 5px;
        font-size: 0.9rem;
      }

      /* Results Section */
      .results {
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .results-header {
        background: linear-gradient(135deg, #8b5cf6, #a855f7);
        color: white;
        padding: 1.5rem;
        text-align: center;
      }

      .results-header h2 {
        font-size: 1.8rem;
        margin-bottom: 0.5rem;
      }

      .results-count {
        opacity: 0.9;
        font-size: 1rem;
      }

      .hostel-list {
        padding: 1.5rem;
      }

      .hostel-card {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .hostel-card:hover {
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .hostel-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(135deg, #8b5cf6, #a855f7);
      }

      .hostel-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
      }

      .hostel-title {
        flex: 1;
      }

      .hostel-title h3 {
        font-size: 1.4rem;
        color: #333;
        margin-bottom: 0.3rem;
      }

      .hostel-location {
        color: #666;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      .price-tag {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 0.8rem 1.2rem;
        border-radius: 8px;
        text-align: center;
        min-width: 120px;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
      }

      .price-tag .amount {
        font-size: 1.3rem;
        font-weight: bold;
        display: block;
      }

      .price-tag .period {
        font-size: 0.8rem;
        opacity: 0.9;
      }

      .hostel-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1rem;
      }

      .detail-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem;
        background: #f8f9fa;
        border-radius: 5px;
      }

      .detail-icon {
        width: 20px;
        height: 20px;
        background: #8b5cf6;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 0.7rem;
      }

      .amenities {
        margin-bottom: 1rem;
      }

      .amenities h4 {
        color: #333;
        margin-bottom: 0.5rem;
        font-size: 1rem;
      }

      .amenities-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .amenity-tag {
        background: #e0e7ff;
        color: #5b21b6;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
      }

      .hostel-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
      }

      .btn-view {
        background: #f3f4f6;
        color: #374151;
        border: 1px solid #d1d5db;
        padding: 0.6rem 1.2rem;
        border-radius: 5px;
        text-decoration: none;
        font-size: 0.9rem;
        transition: all 0.3s;
      }

      .btn-view:hover {
        background: #e5e7eb;
        color: #111827;
      }

      .btn-book {
        background: linear-gradient(135deg, #8b5cf6, #a855f7);
        color: white;
        border: none;
        padding: 0.6rem 1.5rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.3s;
        box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
      }

      .btn-book:hover {
        background: linear-gradient(135deg, #7c3aed, #9333ea);
        transform: translateY(-1px);
        box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
      }

      .availability {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: #10b981;
        color: white;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
      }

      .availability.limited {
        background: #f59e0b;
      }

      .availability.full {
        background: #ef4444;
      }

      /* Responsive Design */
      @media (max-width: 968px) {
        .main-content {
          grid-template-columns: 1fr;
        }
        
        .filters {
          position: static;
        }
      }

      @media (max-width: 768px) {
        .nav-links {
          display: none;
        }

        .search-form {
          flex-direction: column;
          align-items: stretch;
        }

        .budget-inputs {
          flex-direction: column;
        }

        .budget-inputs span {
          display: none;
        }

        .hostel-header {
          flex-direction: column;
          gap: 1rem;
        }

        .hostel-details {
          grid-template-columns: 1fr;
        }

        .hostel-actions {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <nav>
        <div class="logo">Hostel Hive</div>
        <ul class="nav-links">
          <li><a href="#home">Home</a></li>
          <li><a href="#housing">Find Housing</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="#contact">Contact</a></li>
          <li id="auth-links"></li>
        </ul>
      </nav>
    </header>

    <!-- Search Bar -->
    <section class="search-bar">
      <div class="search-container">
        <div class="search-form">
          <input
            type="text"
            class="search-input"
            placeholder="Enter location"
          
          />
          <div class="budget-inputs">
            <input type="number" placeholder="Min (KSH)" value="5000" />
            <span>-</span>
            <input type="number" placeholder="Max (KSH)" value="15000" />
          </div>
          <button class="search-btn">Update Search</button>
        </div>
      </div>
    </section>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Filters Sidebar -->
      <aside class="filters">
        <h3>Filter Results</h3>
        
        <div class="filter-group">
          <h4>Room Type</h4>
          <div class="filter-options">
            <label><input type="checkbox" checked> Single Room</label>
            <label><input type="checkbox" checked> Shared Room</label>
            <label><input type="checkbox"> Studio</label>
            <label><input type="checkbox"> Bedsitter</label>
          </div>
        </div>

        <div class="filter-group">
          <h4>Amenities</h4>
          <div class="filter-options">
            <label><input type="checkbox"> Wi-Fi</label>
            <label><input type="checkbox"> Laundry</label>
            <label><input type="checkbox"> Kitchen</label>
            <label><input type="checkbox"> Parking</label>
            <label><input type="checkbox"> Security</label>
            <label><input type="checkbox"> Study Room</label>
          </div>
        </div>

        <div class="filter-group">
          <h4>Distance</h4>
          <div class="filter-options">
            <label><input type="checkbox"> Under 1km</label>
            <label><input type="checkbox"> 1-3km</label>
            <label><input type="checkbox"> 3-5km</label>
            <label><input type="checkbox"> 5km+</label>
          </div>
        </div>

        <div class="filter-group">
          <h4>Price Range</h4>
          <div class="price-range">
            <input type="range" min="3000" max="25000" value="5000" id="minPrice">
            <input type="range" min="3000" max="25000" value="15000" id="maxPrice">
            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #666;">
              <span>KSH 5,000</span>
              <span>KSH 15,000</span>
            </div>
          </div>
        </div>
      </aside>

      <!-- Results Section -->
      <main class="results">
        <div class="results-header">
          <h2>Available Hostels</h2>
          <p class="results-count">12 hostels found near University of Nairobi</p>
          <p class="price-range-display">Price Range: KSH 5,000 - KSH 15,000</p>
        </div>

        <div class="hostel-list">
          <!-- Dynamic hostel cards will be inserted here -->
        </div>

        <!-- Load More Button -->
        <div style="text-align: center; margin-top: 2rem;">
          <button class="btn btn-primary">Load More Hostels</button>
        </div>
      </main>
    </div>

  <script>
document.addEventListener('DOMContentLoaded', function() {
  // Function to get cookie by name
  function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) return parts.pop().split(';').shift();
    return null;
  }

  // Check for JWT token in cookie
  const jwtToken = getCookie('jwtToken');
  const authLinks = document.getElementById('auth-links');

  if (jwtToken) {
    authLinks.innerHTML = '<a href="#" class="btn-logout hover:opacity-80">Logout</a>';
  } else {
    authLinks.innerHTML = `
      <a href="login.html" class="hover:opacity-80">Sign In</a>
      <span class="mx-2">|</span>
      <a href="register-student.html" class="hover:opacity-80">Sign Up</a>
    `;
  }

  // Logout functionality
  const logoutBtn = document.querySelector('.btn-logout');
  if (logoutBtn) {
    logoutBtn.addEventListener('click', function(e) {
      e.preventDefault();
      document.cookie = 'jwtToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
      alert('You have been logged out.');
      window.location.href = 'login.html';
    });
  }

  const hostelList = document.querySelector('.hostel-list');
  const resultsCount = document.querySelector('.results-count');
  const priceRangeDisplay = document.querySelector('.price-range-display');
  const searchInput = document.querySelector('.search-input');
  const budgetInputs = document.querySelectorAll('.budget-inputs input');
  let hostels = [];

  // Initialize search inputs from sessionStorage
  const searchLocation = sessionStorage.getItem('searchLocation') || '';
  const minBudget = sessionStorage.getItem('minBudget') || '5000';
  const maxBudget = sessionStorage.getItem('maxBudget') || '15000';

  if (searchInput) {
    searchInput.value = searchLocation;
  }
  if (budgetInputs.length === 2) {
    budgetInputs[0].value = minBudget;
    budgetInputs[1].value = maxBudget;
  }

  // Load hostels from sessionStorage or fetch from API
  const storedHostels = sessionStorage.getItem('searchResults');
  if (storedHostels) {
    try {
      hostels = JSON.parse(storedHostels);
    } catch (e) {
      console.error('Error parsing stored hostels:', e);
      hostels = [];
    }
  }

  // If no stored hostels, fetch from API
  if (hostels.length === 0) {
    fetchHostelsByPriceRange(minBudget, maxBudget);
  } else {
    displayHostels(hostels);
  }

  // Update price range display
  updatePriceRangeDisplay(minBudget, maxBudget);

  // Function to fetch hostels by price range and location
  function fetchHostelsByPriceRange(minPrice, maxPrice) {
    const location = sessionStorage.getItem('searchLocation') || '';
    if (!location) {
      alert('Please enter a location');
      if (resultsCount) {
        resultsCount.textContent = 'No hostels found. Please specify a location.';
      }
      hostelList.innerHTML = '';
      return;
    }

    const url = `http://localhost:8099/api/hostels/search?location=${encodeURIComponent(location)}&minPrice=${minPrice}&maxPrice=${maxPrice}`;
    
    fetch(url)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('Fetched hostels:', data);
        if (Array.isArray(data)) {
          hostels = data;
          sessionStorage.setItem('searchResults', JSON.stringify(data));
          displayHostels(data);
        } else {
          console.error('Expected array but got:', typeof data);
          hostels = [];
          displayHostels([]);
        }
      })
      .catch(error => {
        console.error('Error fetching hostels:', error);
        alert('Error fetching hostels. Please check your connection and try again.');
        hostels = [];
        displayHostels([]);
      });
  }

  // Function to fetch all hostels
  function fetchAllHostels() {
    const location = sessionStorage.getItem('searchLocation') || '';
    const url = location 
      ? `http://localhost:8099/api/hostels/search?location=${encodeURIComponent(location)}`
      : 'http://localhost:8099/api/hostels/all';
    
    fetch(url)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('Fetched all hostels:', data);
        if (Array.isArray(data)) {
          hostels = data;
          sessionStorage.setItem('searchResults', JSON.stringify(data));
          displayHostels(data);
        } else {
          console.error('Expected array but got:', typeof data);
          hostels = [];
          displayHostels([]);
        }
      })
      .catch(error => {
        console.error('Error fetching all hostels:', error);
        alert('Error fetching hostels. Please check your connection and try again.');
        hostels = [];
        displayHostels([]);
      });
  }

  // Function to update price range display
  function updatePriceRangeDisplay(minPrice, maxPrice) {
    if (priceRangeDisplay) {
      priceRangeDisplay.textContent = `Price Range: KSH ${parseInt(minPrice || 0).toLocaleString()} - KSH ${parseInt(maxPrice || 1000000).toLocaleString()}`;
    }
  }

  // Function to display hostels
  function displayHostels(hostelsToDisplay) {
    if (!hostelList) {
      console.error('Hostel list element not found');
      return;
    }

    hostelList.innerHTML = ''; // Clear existing content
    
    const location = sessionStorage.getItem('searchLocation') || '';

    if (!Array.isArray(hostelsToDisplay) || hostelsToDisplay.length === 0) {
      if (resultsCount) {
        resultsCount.textContent = `No hostels found near ${location || 'your location'}`;
      }
      return;
    }

    if (resultsCount) {
      resultsCount.textContent = `${hostelsToDisplay.length} hostels found near ${location || 'your location'}`;
    }
    
    hostelsToDisplay.forEach(hostel => {
      const hostelName = hostel.name || 'Unknown Hostel';
      const hostelLocation = hostel.location || 'Unknown Location';
      const hostelPrice = hostel.pricePerMonth || 0;
      const hostelId = hostel.id || Math.random().toString(36).substr(2, 9);
      const availableRooms = hostel.availableRooms || 0;
      const totalRooms = hostel.totalRooms || 0;

      const availability = availableRooms > 0 
        ? availableRooms <= 3 
          ? `<div class="availability limited">${availableRooms} rooms left</div>`
          : `<div class="availability">Available</div>`
        : `<div class="availability full">Fully Booked</div>`;

      let amenitiesHtml = '';
      if (hostel.amenities && Array.isArray(hostel.amenities)) {
        if (hostel.amenities.length > 0) {
          amenitiesHtml = hostel.amenities.map(amenity => {
            const amenityName = typeof amenity === 'string' ? amenity : (amenity.name || amenity.toString());
            return `<span class="amenity-tag">${amenityName.trim()}</span>`;
          }).join('');
        } else {
          amenitiesHtml = '<span class="amenity-tag">Wi-Fi</span>';
        }
      } else {
        amenitiesHtml = '<span class="amenity-tag">Wi-Fi</span>';
      }

      const hostelCard = `
        <div class="hostel-card" data-id="${hostelId}">
          ${availability}
          <div class="hostel-header">
            <div class="hostel-title">
              <h3>${hostelName}</h3>
              <div class="hostel-location">üìç ${hostelLocation}</div>
            </div>
            <div class="price-tag">
              <span class="amount">KSH ${hostelPrice.toLocaleString()}</span>
              <span class="period">per month</span>
            </div>
          </div>
          
          <div class="hostel-details">
            <div class="detail-item">
              <div class="detail-icon">üõèÔ∏è</div>
              <span>${hostel.roomType || 'Single Room'}</span>
            </div>
            <div class="detail-item">
              <div class="detail-icon">üë•</div>
              <span>${hostel.propertyType || 'Mixed Gender'}</span>
            </div>
            <div class="detail-item">
              <div class="detail-icon">üöø</div>
              <span>Shared Bathroom</span>
            </div>
            <div class="detail-item">
              <div class="detail-icon">üîí</div>
              <span>24/7 Security</span>
            </div>
            <div class="detail-item">
              <div class="detail-icon">üìû</div>
              <span>${hostel.contactPhone || 'Contact Available'}</span>
            </div>
          </div>

          <div class="amenities">
            <h4>Amenities</h4>
            <div class="amenities-list">
              ${amenitiesHtml}
            </div>
          </div>

          <div class="hostel-actions">
            <a href="HostelDetails.html?id=${hostelId}" class="btn-view">View Details</a>
            <button class="btn-book" ${availableRooms === 0 ? 'disabled' : ''}>
              ${availableRooms === 0 ? 'Fully Booked' : 'Book Now'}
            </button>
          </div>
        </div>
      `;
      hostelList.insertAdjacentHTML('beforeend', hostelCard);
    });

    document.querySelectorAll('.btn-book').forEach(button => {
      button.addEventListener('click', function() {
        if (this.disabled) return;
        
        const hostelId = this.closest('.hostel-card').getAttribute('data-id');
        sessionStorage.setItem('bookingHostelId', hostelId);
        window.location.href = `book.html?id=${hostelId}`;
      });
    });
  }

  // Update search functionality
  const searchBtn = document.querySelector('.search-btn');
  if (searchBtn) {
    searchBtn.addEventListener('click', function() {
      const locationInput = document.querySelector('.search-input');
      const budgetInputs = document.querySelectorAll('.budget-inputs input');
      
      const location = locationInput ? locationInput.value.trim() : '';
      const minBudget = budgetInputs[0] ? budgetInputs[0].value : '';
      const maxBudget = budgetInputs[1] ? budgetInputs[1].value : '';

      // Validate inputs
      if (location === '') {
        alert('Please enter a location');
        return;
      }

      const minPrice = minBudget ? parseFloat(minBudget) : 0;
      const maxPrice = maxBudget ? parseFloat(maxBudget) : 1000000;

      if (minPrice < 0 || maxPrice < 0) {
        alert('Please enter valid positive numbers for budget.');
        return;
      }

      if (minPrice > maxPrice) {
        alert('Minimum budget cannot be greater than maximum budget.');
        return;
      }

      // Update session storage
      sessionStorage.setItem('searchLocation', location);
      sessionStorage.setItem('minBudget', minPrice.toString());
      sessionStorage.setItem('maxBudget', maxPrice.toString());

      // Update input fields
      if (searchInput) searchInput.value = location;
      if (budgetInputs.length === 2) {
        budgetInputs[0].value = minPrice.toString();
        budgetInputs[1].value = maxPrice.toString();
      }

      // Fetch hostels with new criteria
      fetchHostelsByPriceRange(minPrice, maxPrice);
    });
  }

  // Filter functionality
  const filterCheckboxes = document.querySelectorAll('.filter-options input[type="checkbox"]');
  const priceSliders = document.querySelectorAll('.price-range input[type="range"]');

  filterCheckboxes.forEach(checkbox => {
    checkbox.addEventListener('change', applyFilters);
  });

  priceSliders.forEach(slider => {
    slider.addEventListener('input', function() {
      const minPriceSlider = document.getElementById('minPrice');
      const maxPriceSlider = document.getElementById('maxPrice');
      const priceDisplay = document.querySelector('.price-range div');
      
      if (minPriceSlider && maxPriceSlider && priceDisplay) {
        const minPrice = minPriceSlider.value;
        const maxPrice = maxPriceSlider.value;
        priceDisplay.innerHTML = `
          <span>KSH ${parseInt(minPrice).toLocaleString()}</span>
          <span>KSH ${parseInt(maxPrice).toLocaleString()}</span>
        `;
        applyFilters();
      }
    });
  });

  function applyFilters() {
    const minPriceSlider = document.getElementById('minPrice');
    const maxPriceSlider = document.getElementById('maxPrice');
    
    if (!minPriceSlider || !maxPriceSlider) return;

    const minPrice = parseInt(minPriceSlider.value);
    const maxPrice = parseInt(maxPriceSlider.value);
    
    const roomTypeCheckboxes = document.querySelectorAll('.filter-group:nth-child(1) input:checked');
    const amenityCheckboxes = document.querySelectorAll('.filter-group:nth-child(2) input:checked');
    const distanceCheckboxes = document.querySelectorAll('.filter-group:nth-child(3) input:checked');

    const roomTypes = Array.from(roomTypeCheckboxes)
      .map(cb => cb.parentElement.textContent.trim());
    const amenities = Array.from(amenityCheckboxes)
      .map(cb => cb.parentElement.textContent.trim());
    const distances = Array.from(distanceCheckboxes)
      .map(cb => cb.parentElement.textContent.trim());

    let filteredHostels = [...hostels];

    // Apply price filter
    filteredHostels = filteredHostels.filter(hostel => 
      (hostel.pricePerMonth || 0) >= minPrice && (hostel.pricePerMonth || 0) <= maxPrice
    );

    // Apply room type filter
    if (roomTypes.length > 0) {
      filteredHostels = filteredHostels.filter(hostel => 
        roomTypes.includes(hostel.roomType || ''));
    }

    // Apply amenities filter
    if (amenities.length > 0) {
      filteredHostels = filteredHostels.filter(hostel => {
        if (!hostel.amenities || !Array.isArray(hostel.amenities)) return false;

        const hostelAmenities = hostel.amenities.map(amenity => {
          const amenityName = typeof amenity === 'string' ? amenity : (amenity.name || amenity.toString());
          return amenityName.trim().toLowerCase();
        });

        return amenities.every(amenity => 
          hostelAmenities.includes(amenity.trim().toLowerCase())
        );
      });
    }

    // Apply distance filter
    if (distances.length > 0) {
      filteredHostels = filteredHostels.filter(hostel => {
        if (!hostel.distance) return true;
        const dist = parseFloat(hostel.distance);
        return distances.some(range => {
          if (range === 'Under 1km') return dist < 1;
          if (range === '1-3km') return dist >= 1 && dist <= 3;
          if (range === '3-5km') return dist > 3 && dist <= 5;
          if (range === '5km+') return dist > 5;
          return true;
        });
      });
    }

    displayHostels(filteredHostels);
  }

  // Load more functionality
  const loadMoreBtn = document.querySelector('.btn-primary');
  if (loadMoreBtn) {
    loadMoreBtn.addEventListener('click', function() {
      this.textContent = 'Loading...';
      this.disabled = true;
      
      setTimeout(() => {
        this.textContent = 'Load More Hostels';
        this.disabled = false;
        alert('More hostels loaded! (In a real app, this would load additional results via pagination)');
      }, 1500);
    });
  }

  // Mobile responsiveness
  window.addEventListener('resize', function() {
    const navLinks = document.querySelector('.nav-links');
    if (navLinks) {
      if (window.innerWidth <= 768) {
        navLinks.style.display = 'none';
      } else {
        navLinks.style.display = 'flex';
      }
    }
  });
});
</script>
  </body>
</html>